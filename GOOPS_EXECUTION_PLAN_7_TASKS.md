# برنامه اجرایی ۷ تسک جامع سامانه گُوپس

## Task 1 – زیرساخت سرویس‌های خارجی و لایه‌های انتزاعی
**هدف:**  ایجاد ستون فقرات فنی برای جایگزینی سرویس‌های بین‌المللی با ارائه‌دهندگان بومی و تضمین اینکه زیرساخت پیام‌رسانی، نقشه، کش و لاگینگ به شکل ماژولار و قابل پیکربندی عمل کند. این گام پیش‌نیاز تمام اصلاحات بومی‌سازی در اسناد `ANALYSIS.md` و `ROADMAP.md` است.
**Subtasks (زیرکارها):**
- [T-101] طراحی لایه `MapProvider` انتزاعی در بک‌اند (`protected/components`) جهت جداکردن وابستگی نقشه از منطق تجاری. (از لیست ۲۰تایی #1 و تحلیل معماری)
- [T-102] پیاده‌سازی ارائه‌دهنده `NeshanMapProvider` و افزودن تنظیمات آن در پنل ادمین. (لیست ۲۰تایی #2، سناریوی نقشه در `TEST_SCENARIOS.md`)
- [T-103] استخراج و متمرکزسازی ارسال پیامک در سرویسی مستقل با اینترفیس واحد. (لیست ۲۰تایی #6، نیازمندی‌های `ANALYSIS.md`)
- [T-104] توسعه آداپتور پیامک برای سرویس‌دهنده ایرانی و اتصال آن به تنظیمات. (لیست ۲۰تایی #7، چک‌لیست وابستگی‌های خارجی)
- [T-105] ممیزی تنظیمات Realtime (Firebase/Pusher) و مستندسازی گزینه‌های جایگزین یا پراکسی داخلی. (لیست ۲۰تایی #8، ریسک‌های `QA_EVALUATION.md`)
- [T-106] افزودن لایه کش (Redis/File) برای کوئری‌های پرتکرار API و ثبت سیاست انقضا. (لیست ۲۰تایی #18)
- [T-107] طراحی سرویس لاگ مرکزی برای تراکنش‌ها و رویدادهای حیاتی با خروجی قابل مانیتورینگ. (لیست ۲۰تایی #19، ریسک پرداخت در `QA_EVALUATION.md`)
**Dependencies (وابستگی‌ها):**
- این تسک پس از مطالعه کامل مستندات فاز تحلیل (`ANALYSIS.md`, `ROADMAP.md`) آغاز می‌شود.
- پیش‌نیاز تسک‌های 2، 3، 4 و 7 است؛ زیرا نقشه، پرداخت، جریان سفارش و مستندسازی بر این لایه‌ها تکیه دارند.
**Deliverables (خروجی‌های قابل تحویل):**
- ماژول‌های `MapProvider`, `SmsProvider`, `RealtimeProvider`, `CacheService`, `CentralLogger` در بک‌اند با اسناد پیکربندی.
- تنظیمات پنل ادمین برای مدیریت کلیدهای Neshan، SMS، Realtime و کش.
- مستند فنی شامل نحوه افزودن ارائه‌دهندگان جدید و جریان‌های خطای لاگ شده.

## Task 2 – ماژول نقشه و مناطق سرویس‌دهی در کلاینت‌ها
**هدف:**  تضمین تجربه یکپارچه نقشه برای مشتری، مامان، راننده و KDS با استفاده از زیرساخت جدید نشان، همگام با منطق مناطق در بک‌اند و رفع ریسک بارگذاری اسکریپت که در `QA_EVALUATION.md` ثبت شده است.
**Subtasks (زیرکارها):**
- [T-201] جایگزینی کامپوننت‌های `vue3-google-map` با `NeshanMap` بومی در تمام اپ‌های Quasar (`MobileVue`, `MerchantVue`, `DriverVue`, `KicthenMobile`). (لیست ۲۰تایی #3)
- [T-202] همگام‌سازی تعریف Zone/Polygon بین پنل ادمین و اپ‌ها، شامل سریال‌سازی استاندارد و تست API. (مسائل `ROADMAP.md` و `TEST_SCENARIOS.md`)
- [T-203] بارگذاری تنبل و ایمن اسکریپت نقشه برای جلوگیری از کرش در حالت آفلاین. (ریسک ۵ در `QA_EVALUATION.md`)
- [T-204] افزودن تست‌های تعاملی دستی/خودکار برای سناریوهای نقشه و آدرس‌دهی. (نیازمندی سناریوهای نقشه در `TEST_SCENARIOS.md`)
**Dependencies (وابستگی‌ها):**
- باید پس از تکمیل Task 1 (برای دریافت لایه MapProvider و تنظیمات API) شروع شود.
- خروجی آن ورودی Task 4 (جریان سفارش) و Task 6 (تست) است.
**Deliverables (خروجی‌های قابل تحویل):**
- کامپوننت‌های نقشه جدید در هر اپ با مستند استفاده.
- API هماهنگ برای Zone/Polygon و تست‌های پذیرش پوشش‌دهنده سناریوهای نقشه.
- سند راهنمای عیب‌یابی بارگذاری نقشه در حالت‌های آفلاین/ضعیف.

## Task 3 – پرداخت زرین‌پال، مغایرت‌ها و گزارش تسویه
**هدف:**  تکمیل چرخه پرداخت بومی با مدیریت خطا، ثبت لاگ و ارائه گزارش‌های مالی دقیق مطابق هشدارهای `QA_EVALUATION.md` و نیازمندی‌های `FINAL_CHECKLIST.md`.
**Subtasks (زیرکارها):**
- [T-301] توسعه ماژول/کنترلر زرین‌پال در بک‌اند و اتصال آن به پنل تنظیمات. (لیست ۲۰تایی #4، مسیرهای `ROADMAP.md`)
- [T-302] مدیریت کامل سناریوهای failure، انصراف و تایم‌اوت در پرداخت و همگام‌سازی وضعیت سفارش. (لیست ۲۰تایی #5، ریسک ۲ در `QA_EVALUATION.md`)
- [T-303] افزودن ستون‌ها و نماهای گزارش‌گیری جدید برای تسویه و مغایرت در دیتابیس. (لیست ۲۰تایی #13)
- [T-304] یکپارچه‌سازی تراکنش‌ها با سرویس لاگ مرکزی برای پیگیری و هشدار. (وابسته به Task 1، همسو با آیتم‌های Anti-Forgetting در `FINAL_CHECKLIST.md`)
**Dependencies (وابستگی‌ها):**
- شروع پس از Task 1 (برای دسترسی به لاگ مرکزی و پیکربندی سرویس‌ها).
- پیش‌نیاز Task 4 (برای به‌روزرسانی جریان سفارش) و Task 6 (برای سناریوهای تست پرداخت).
**Deliverables (خروجی‌های قابل تحویل):**
- ماژول زرین‌پال با مدارک Sandbox/Production، کنترلر و view تنظیمات.
- گزارش‌های مالی شامل وضعیت پرداخت، تسویه، مغایرت و خروجی‌های CSV/Excel.
- داشبورد مانیتورینگ یا گزارش لاگ مرکزی برای رویدادهای پرداخت و هشدار خطا.

## Task 4 – منطق سفارش، موجودی و پشتیبانی از مامان‌ها
**هدف:**  کامل‌سازی فرآیند سفارش از نگاه مامان و مشتری با تاکید بر مدیریت موجودی، ثبت شکایات و بهبود تجربه کاربری مامان طبق نیازهای مطرح‌شده در `ANALYSIS.md` و `FINAL_CHECKLIST.md`.
**Subtasks (زیرکارها):**
- [T-401] پیاده‌سازی منطق کاهش `stock` پس از تایید سفارش و پوشش سناریوهای لغو/بازپرداخت. (لیست ۲۰تایی #11، ریسک ۴ در `QA_EVALUATION.md`)
- [T-402] توسعه ماژول ثبت و پیگیری شکایات مشتری در پنل ادمین و اپ مامان. (لیست ۲۰تایی #9)
- [T-403] طراحی داشبورد مامان با KPIهای کلیدی روزانه (سفارش، ظرفیت، درآمد). (لیست ۲۰تایی #10، نیازهای UX در `FINAL_CHECKLIST.md`)
- [T-404] بازطراحی فرآیند آنبوردینگ مامان با چک‌لیست مدارک و وضعیت پیشرفت. (لیست ۲۰تایی #20)
- [T-405] بازنگری جریان مشتری-مامان بر اساس سناریوهای `TEST_SCENARIOS.md` برای اطمینان از سازگاری.
**Dependencies (وابستگی‌ها):**
- وابسته به Task 2 (اطمینان از دسترسی به نقشه و مناطق) و Task 3 (وضعیت پرداخت دقیق).
- خروجی آن ورودی Task 5 (برای پیام‌رسانی و متون)، Task 6 (برای تست E2E) است.
**Deliverables (خروجی‌های قابل تحویل):**
- منطق سفارش به‌روزشده با تست واحد/یکپارچه و مستند جریان‌های استثناء.
- صفحات و APIهای جدید برای شکایات و داشبورد مامان با گزارش‌های مرتبط.
- اسناد فرآیند آنبوردینگ مامان و راهنمای پشتیبانی.

## Task 5 – بومی‌سازی نهایی زبان، تومان، شمسی و UX
**هدف:**  رساندن تجربه کاربری به استاندارد بومی با پوشش زبان، فرمت‌ها، پیام‌ها و محتوای فارسی مطابق بخش‌های باز در `FINAL_CHECKLIST.md` و `TEST_SCENARIOS.md`.
**Subtasks (زیرکارها):**
- [T-501] ممیزی کامل نمایش تومان و حذف اعشار در همه کانال‌ها (وب، اپ، ایمیل، گزارش). (تداوم کارهای فاز ۲ در `ROADMAP.md`)
- [T-502] همگام‌سازی تاریخ شمسی در UI، ایمیل‌ها و اعلان‌های Push با فیلترهای مناسب. (لیست ۲۰تایی #12، ریسک ۱ در `QA_EVALUATION.md`)
- [T-503] ایجاد ساختار چندزبانه Quasar با فایل‌های ترجمه ماژولار و انتخاب زبان. (لیست ۲۰تایی #14)
- [T-504] بازبینی RTL، لحن ترجمه‌ها، پیام‌های خطا و صفحات استاتیک طبق آیتم‌های باز `FINAL_CHECKLIST.md`.
- [T-505] اطمینان از یکپارچگی محتوا در فرآیندهای جدید مامان/مشتری پس از Task 4.
**Dependencies (وابستگی‌ها):**
- آغاز پس از Task 4 (برای آگاهی از جریان‌های نهایی) و همگام با Task 7 (برای مستندسازی تغییرات ترجمه).
- پیش‌نیاز Task 6 جهت تعریف تست‌های بومی‌سازی.
**Deliverables (خروجی‌های قابل تحویل):**
- فایل‌های ترجمه و تنظیمات RTL به‌روزشده در تمام اپ‌ها.
- راهنمای سبک محتوا (tone & voice) و استانداردهای تاریخ/واحد پول.
- نتایج بازبینی صفحات کلیدی با اسکرین‌شات و چک‌لیست تکمیل‌شده.

## Task 6 – تضمین کیفیت، تست‌های E2E و آماده‌سازی لانچ
**هدف:**  تثبیت کیفیت سامانه پیش از لانچ با همگام‌سازی سناریوهای تست، پوشش خودکار و همخوانی با `FINAL_CHECKLIST.md` و `QA_EVALUATION.md`.
**Subtasks (زیرکارها):**
- [T-601] به‌روزرسانی `TEST_SCENARIOS.md` بر اساس تغییرات Tasks 1–5 و اضافه کردن سناریوهای جدید (پرداخت failure، شکایات، نقشه آفلاین).
- [T-602] پیاده‌سازی تست‌های E2E حداقلی با Cypress یا Playwright برای جریان‌های مشتری و مامان. (لیست ۲۰تایی #15)
- [T-603] همگام‌سازی و تکمیل `FINAL_CHECKLIST.md` و `QA_EVALUATION.md` با نتایج جدید، علامت‌گذاری ریسک‌های باقی‌مانده.
- [T-604] تعریف فرآیند Regression Manual با استفاده از سناریوهای مستندسازی‌شده و گزارش‌دهی نتایج.
**Dependencies (وابستگی‌ها):**
- وابسته به تکمیل حداقلی Tasks 1–5 برای دسترسی به جریان‌های پایدار.
- خروجی آن ورودی فرآیند تحویل نهایی و مستندسازی Task 7 است.
**Deliverables (خروجی‌های قابل تحویل):**
- نسخه به‌روز سناریوهای تست و چک‌لیست‌ها با وضعیت Pass/Fail.
- اسکریپت‌های تست E2E همراه با گزارش اجرا (HTML/JUnit) و دستور اجرای مستند.
- گزارش QA نهایی شامل جمع‌بندی باگ‌های باز و پیشنهادهای بهبود.

## Task 7 – مستندسازی و تجربه توسعه‌دهنده
**هدف:**  ایجاد تجربه توسعه‌دهنده منسجم با راهنماهای نصب، پیکربندی و conventions جدید تا تیم بتواند تغییرات بومی‌سازی را پایدار نگه دارد؛ مطابق نیازهای باز در `FINAL_CHECKLIST.md` و تاکید `GOOPS_SYSTEM_MAP.md`.
**Subtasks (زیرکارها):**
- [T-701] نهایی‌سازی و به‌روزرسانی `GOOPS_SYSTEM_MAP.md` و سایر اسناد Julius با انعکاس تغییرات Tasks 1–6.
- [T-702] تدوین README ریشه با دستورالعمل نصب Backend/Frontend، راه‌اندازی دیتابیس و اجرای تست‌ها. (لیست ۲۰تایی #16)
- [T-703] ایجاد راهنمای پیکربندی برای کلیدهای Neshan، زرین‌پال، SMS، Cache و Realtime (همسو با Task 1 و 3). (لیست ۲۰تایی #8 مرتبط با config)
- [T-704] تعریف conventions جدید (نام‌گذاری وضعیت سفارش، ساختار ترجمه، ساختار لاگ) و مستندسازی آن‌ها.
- [T-705] مستندسازی بهینه‌سازی باندل‌های Quasar (Code Splitting، Lazy Loading) و اعمال پیکربندی لازم. (لیست ۲۰تایی #17)
**Dependencies (وابستگی‌ها):**
- باید پس از در دسترس بودن خروجی‌های اولیه Tasks 1–5 آغاز شود تا اطلاعات دقیق مستند شود؛ با Task 6 برای خروجی تست هماهنگ گردد.
- خروجی آن برای تحویل پروژه و آموزش تیم ضروری است.
**Deliverables (خروجی‌های قابل تحویل):**
- README جامع، راهنمای پیکربندی و اسناد conventions در ریشه ریپو.
- نسخه نهایی اسناد سیستم (System Map، Domain Overview، Roadmap به‌روزشده) با لینک‌های متقابل.
- بخش «Developer Onboarding» شامل چک‌لیست نصب، اجرای تست و راهنمای بیلد Quasar.
